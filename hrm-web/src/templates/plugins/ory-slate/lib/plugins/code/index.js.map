{"version":3,"sources":["../../../src/plugins/code/index.js"],"names":["CODE","CodePlugin","props","DEFAULT_NODE","Plugin","createButton","type","icon","Button","editorState","onChange","onClick","e","preventDefault","value","change","toggleMark","isActive","marks","some","mark","createNodeButton","blocks","block","setBlocks","name","schema","nodes","Code","hoverButtons","toolbarButtons","deserialize","el","next","tagName","toLowerCase","object","data","Data","create","childNodes","serialize","children","overflow","renderMark","attributes","renderNode","node"],"mappings":"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","file":"index.js","sourcesContent":["/*\n * This file is part of ORY Editor.\n *\n * ORY Editor is free software: you can redistribute it and/or modify\n * it under the terms of the GNU Lesser General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * ORY Editor is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with ORY Editor.  If not, see <http://www.gnu.org/licenses/>.\n *\n * @license LGPL-3.0\n * @copyright 2016-2018 Aeneas Rekkas\n * @author Aeneas Rekkas <aeneas+oss@aeneas.io>\n *\n */\n\n/* eslint-disable prefer-reflect, default-case, react/display-name */\nimport React from 'react'\nimport CodeIcon from '@material-ui/icons/Code'\nimport { Data } from 'slate'\nimport { makeTagMark, ToolbarButton } from '../../helpers'\nimport Plugin from '../Plugin'\nimport Code from './node'\nimport type { Props } from '../props'\n\nexport const CODE = 'CODE/CODE'\n\nexport default class CodePlugin extends Plugin {\n  constructor(props: Props) {\n    super(props)\n\n    this.DEFAULT_NODE = props.DEFAULT_NODE\n  }\n\n  props: Props\n\n  createButton = (type, icon) => {\n    const Button = ({ editorState, onChange }: Props) => {\n      const onClick = e => {\n        e.preventDefault()\n\n        onChange({\n          value: editorState\n            .change()\n            .toggleMark(type)\n            .value\n        })\n      }\n\n      const isActive =\n        editorState && editorState.marks.some(mark => mark.type === type)\n\n      return <ToolbarButton onClick={onClick} isActive={isActive} icon={icon} />\n    }\n\n    return Button\n  }\n\n  createNodeButton = (type, icon) => {\n    const Button = ({ editorState, onChange }: Props) => {\n      const onClick = e => {\n        e.preventDefault()\n\n        const isActive = editorState.blocks.some(block => block.type === type)\n\n        onChange({\n          value: editorState\n            .change()\n            .setBlocks(isActive ? this.DEFAULT_NODE : type)\n            .value\n        })\n      }\n\n      const isActive = editorState.blocks.some(block => block.type === type)\n\n      return <ToolbarButton onClick={onClick} isActive={isActive} icon={icon} />\n    }\n\n    return Button\n  }\n\n  name = 'code'\n  schema = {\n    marks: { [CODE]: makeTagMark('code') },\n    nodes: { [CODE]: Code }\n  }\n\n  hoverButtons = [this.createButton(CODE, <CodeIcon />)]\n  toolbarButtons = [this.createNodeButton(CODE, <CodeIcon />)]\n\n  deserialize = (el, next) => {\n    switch (el.tagName.toLowerCase()) {\n      case 'code':\n        return {\n          object: 'mark',\n          type: CODE,\n          data: Data.create({}),\n          nodes: next(el.childNodes)\n        }\n      case 'pre':\n        return {\n          object: 'block',\n          type: CODE,\n          nodes: next(el.childNodes)\n        }\n    }\n  }\n\n  serialize = (\n    object: { type: string, object: string, data: any },\n    children: any[]\n  ) => {\n    if (object.object === 'mark') {\n      switch (object.type) {\n        case CODE:\n          return <code className=\"ory-plugins-content-slate-code\">{children}</code>\n      }\n    } else if (object.object === 'block') {\n      switch (object.type) {\n        case CODE:\n          return (\n            <pre style={{ overflow: 'scroll' }}>\n              <code>{children}</code>\n            </pre>\n          )\n      }\n    }\n  }\n\n  renderMark = props => {\n    const { children, mark, attributes } = props\n\n    switch (mark.type) {\n      case CODE:\n        return <code {...attributes} className=\"ory-plugins-content-slate-code\">{children}</code>\n    }\n  }\n\n  renderNode = props => {\n    const { node } = props\n\n    switch (node.type) {\n      case CODE:\n        return <Code {...props}/>\n    }\n  }\n}\n"]}